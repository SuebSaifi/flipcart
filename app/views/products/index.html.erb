<%if user_signed_in? %>
<div class="d-flex flex-wrap mx-3">
<%@products.each do |product|%>
    <%# <%=product.title%>
   <div class="card mx-4 my-3" style="width: 18rem;">
     <%if product.image.present?%>
      <%=image_tag product.image ,class:"card-img-top",width: "286px",height: '200px',alt:"abcd"%>
      <%else%>
        <%= image_tag "default/download.jpeg",class:"card-img-top",width: "286px",height: '200px' %>
      <%end%>
    <div class="card-body">
      <p class="card-text"><%=product.description%>.</p>
    </div>
     <div class="card-body">
      <b class="card-text"><span>Price:</span><%=product.price%></b>
      <%=product.stripe_product_id%>
    </div>
    
      <%=link_to "#{product.title}",product_path(product.id)%>
       <%# <%debugger%>   
      <div class="d-flex " id='wish_<%=product.id%>'>
      <%=render "wishlists/toggle",product_id: product.id%>
      
      </div>
      <div class="d-flex " id='wish_<%=product.id%>'>
       <%=button_to "Add to cart", line_items_path(:product_id => product.id)%>
       </div>
       <%=button_to 'Buy Now','javascript:',onclick:"goToCheckout(#{product.id})", id:"checkout-button" %>
     
    </div>
<%end%>
</div>
<%end%>

<script>
  function goToCheckout(id){
    console.log("test")
    $.ajax({
      url: '/checkout/create',
      type: 'POST',
      dataType: 'script',
      data: {id: id}
    })
  }
</script>